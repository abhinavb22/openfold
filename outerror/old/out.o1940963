
[2024-09-07 18:26:40,023] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[3, 3]
Trainer device info:
  Number of devices: 3
  Number of nodes: 2
  Parallel devices: <pytorch_lightning.strategies.deepspeed.DeepSpeedStrategy object at 0x14b186792a40>
Number of GPUs in DeepSpeed config: {'fp16': {'enabled': False, 'min_loss_scale': 1}, 'amp': {'enabled': False, 'opt_level': 'O2'}, 'bfloat16': {'enabled': True}, 'zero_optimization': {'stage': 2, 'offload_optimizer': {'device': 'cpu'}, 'contiguous_gradients': True}, 'activation_checkpointing': {'partition_activations': True, 'cpu_checkpointing': False, 'profile': False}, 'gradient_clipping': 0.1, 'zero_force_ds_cpu_optimizer': False}
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/5 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/5 [00:00<?, ?it/s] dict_keys(['aatype', 'residue_index', 'seq_length', 'msa', 'num_alignments', 'template_aatype', 'template_all_atom_mask', 'template_all_atom_positions', 'all_atom_positions', 'all_atom_mask', 'resolution', 'asym_id', 'sym_id', 'entity_id', 'deletion_matrix', 'seq_mask', 'msa_mask', 'msa_profile', 'target_feat', 'atom14_atom_exists', 'residx_atom14_to_atom37', 'residx_atom37_to_atom14', 'atom37_atom_exists', 'extra_msa', 'extra_deletion_matrix', 'extra_msa_mask', 'bert_mask', 'true_msa', 'cluster_profile', 'cluster_deletion_mean', 'msa_feat', 'use_clamped_fape', 'batch_idx', 'no_recycling_iters', 'gt_features']) torch.Size([1, 384, 2])
Epoch 0:  20%|██        | 1/5 [00:28<01:52,  0.04it/s]Epoch 0:  20%|██        | 1/5 [00:28<01:52,  0.04it/s, v_num=n0v4, train/loss=61.80]dict_keys(['aatype', 'residue_index', 'seq_length', 'msa', 'num_alignments', 'template_aatype', 'template_all_atom_mask', 'template_all_atom_positions', 'all_atom_positions', 'all_atom_mask', 'resolution', 'asym_id', 'sym_id', 'entity_id', 'deletion_matrix', 'seq_mask', 'msa_mask', 'msa_profile', 'target_feat', 'atom14_atom_exists', 'residx_atom14_to_atom37', 'residx_atom37_to_atom14', 'atom37_atom_exists', 'extra_msa', 'extra_deletion_matrix', 'extra_msa_mask', 'bert_mask', 'true_msa', 'cluster_profile', 'cluster_deletion_mean', 'msa_feat', 'use_clamped_fape', 'batch_idx', 'no_recycling_iters', 'gt_features']) torch.Size([1, 384, 18])
Epoch 0:  40%|████      | 2/5 [01:48<02:42,  0.02it/s, v_num=n0v4, train/loss=61.80]Epoch 0:  40%|████      | 2/5 [01:48<02:42,  0.02it/s, v_num=n0v4, train/loss=47.70]dict_keys(['aatype', 'residue_index', 'seq_length', 'msa', 'num_alignments', 'template_aatype', 'template_all_atom_mask', 'template_all_atom_positions', 'all_atom_positions', 'all_atom_mask', 'resolution', 'asym_id', 'sym_id', 'entity_id', 'deletion_matrix', 'seq_mask', 'msa_mask', 'msa_profile', 'target_feat', 'atom14_atom_exists', 'residx_atom14_to_atom37', 'residx_atom37_to_atom14', 'atom37_atom_exists', 'extra_msa', 'extra_deletion_matrix', 'extra_msa_mask', 'bert_mask', 'true_msa', 'cluster_profile', 'cluster_deletion_mean', 'msa_feat', 'use_clamped_fape', 'batch_idx', 'no_recycling_iters', 'gt_features']) torch.Size([1, 384, 20])
Epoch 0:  60%|██████    | 3/5 [02:43<01:49,  0.02it/s, v_num=n0v4, train/loss=47.70]Epoch 0:  60%|██████    | 3/5 [02:43<01:49,  0.02it/s, v_num=n0v4, train/loss=232.0]dict_keys(['aatype', 'residue_index', 'seq_length', 'msa', 'num_alignments', 'template_aatype', 'template_all_atom_mask', 'template_all_atom_positions', 'all_atom_positions', 'all_atom_mask', 'resolution', 'asym_id', 'sym_id', 'entity_id', 'deletion_matrix', 'seq_mask', 'msa_mask', 'msa_profile', 'target_feat', 'atom14_atom_exists', 'residx_atom14_to_atom37', 'residx_atom37_to_atom14', 'atom37_atom_exists', 'extra_msa', 'extra_deletion_matrix', 'extra_msa_mask', 'bert_mask', 'true_msa', 'cluster_profile', 'cluster_deletion_mean', 'msa_feat', 'use_clamped_fape', 'batch_idx', 'no_recycling_iters', 'gt_features']) torch.Size([1, 384, 15])
